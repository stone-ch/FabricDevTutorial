<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>CardChain</title>
<link rel="stylesheet" type="text/css" href="css.css">

<script src="jquery-3.3.1.min.js">
</script>
<script>
$(document).ready(function(){
	$("#querytranscationbycardid").click(function(){
		$.ajax({
			type:'GET',
	        url: 'http://localhost:3000/querytranscationbycardid',
	        dataType: 'jsonp',
	        jsonp: "callback",
	        jsonpCallback:"successCallback",
	        data: {
               		cardid: $("#org").val() + $("#cardid").val()
	              },
			success:function(result){
				var str = ""
				for (var i = 0; i < result.length; i++) {
					str += '<tr><td class="btbg1 font-center">' + result[i]["Record"]["TxID"] + '</td><td class="btbg1 font-center">' + result[i]["Record"]["TxTime"] + '</td><td class="btbg1 font-center">' + result[i]["Record"]["TxContent"] + '</td><td class="btbg1 font-center">' + result[i]["Record"]["TxTotalPrice"] + '</td><td class="btbg1 font-center">' + result[i]["Record"]["TxIsUseAgreement"] + '</td><td class="btbg1 font-center">' + result[i]["Record"]["TxIsUsePoint"] + '</td><td class="btbg1 font-center">' + result[i]["Record"]["UserAgreementID"] + '</td><td class="btbg1 font-center">' + result[i]["Record"]["CardID"] + '</td><td class="btbg1 font-center">' + result[i]["Record"]["AgreementID"] + '</td><td class="btbg1 font-center">' + result[i]["Record"]["NumOfPointsUsed"] + '</td><td class="btbg1 font-center">' + result[i]["Record"]["TxLocation"] + '</td><td class="btbg1 font-center">' + result[i]["Record"]["TxOrg"] + '</td></tr>'
					}
				$("#test").html('<tr><td class="btbg font-center titfont">交易ID</td><td class="btbg font-center titfont">交易时间</td><td class="btbg font-center titfont">交易内容</td><td class="btbg font-center titfont">总价</td><td class="btbg font-center titfont">是否使用优惠</td><td class="btbg font-center titfont">是否使用积分</td><td class="btbg font-center titfont">参与的合约ID</td><td class="btbg font-center titfont">卡号</td><td class="btbg font-center titfont">合约ID</td><td class="btbg font-center titfont">使用积分数</td><td class="btbg font-center titfont">交易地点</td><td class="btbg font-center titfont">交易商家</td></tr>' + str);		
			},
			error:function(e){
	            //失败执行
	            alert(e.status+','+ e.statusText);
        }
		});
	});
});
</script>
</head>
<body>
	<ul>
		<li><a class="active" href="issuecard.html">发卡</a></li>
	    <li><a href="querycardbycardid.html">查询卡</a></li>
	    <li><a href="makeagreement.html">发布合约</a></li>
	    <li><a href="queryagreementbyrange.html">查询所有合约</a></li>
	    <li><a href="queryagreementbyagreementid.html">查询合约</a></li>
	    <li><a href="queryuagrbyrange.html">查询所有参与的合约</a></li>
	    <li><a href="queryuagrbyuagrid.html">查询参与的合约</a></li>
	    <li><a href="maketranscation.html">交易</a></li>
	    <li><a href="querytranscationbycardid.html">查询交易</a></li>
	</ul>

	<div style="margin-left:25%;padding:1px 16px;height:1000px;">
		<div id="Header"><center><H1>CardChain-查询卡号交易记录</H1></center></div>
        <button id="querytranscationbycardid">查询卡号交易记录</button>
	    <form>
	    	<fieldset>
	    		<label>开卡组织：</label>
	    		<select id="org">
					<option value="OrgBarberMSP">OrgBarberMSP</option>
					<option value="OrgSupermarketMSP">OrgSupermarketMSP</option>>
				</select></br>
	    		<label>卡号：</label>
	    		<input type="text" id="cardid"></input></br>
	    	</fieldset>
	    </form>
        <table id="test" width="100%" border="0" cellspacing="1" cellpadding="4" bgcolor="#cccccc" class="tabtop13" align="center">
			<tr>
				<td class="btbg font-center titfont">交易ID</td>
				<td class="btbg font-center titfont">交易时间</td>
				<td class="btbg font-center titfont">交易内容</td>
				<td class="btbg font-center titfont">总价</td>
				<td class="btbg font-center titfont">是否使用优惠</td>
				<td class="btbg font-center titfont">是否使用积分</td>
				<td class="btbg font-center titfont">参与的合约ID</td>
				<td class="btbg font-center titfont">卡号</td>
				<td class="btbg font-center titfont">合约ID</td>
				<td class="btbg font-center titfont">使用积分数</td>
				<td class="btbg font-center titfont">交易地点</td>
				<td class="btbg font-center titfont">交易商家</td>
			</tr>
			<tr>
				<td class="btbg1 font-center">&nbsp;</td>
				<td class="btbg1 font-center">&nbsp;</td>
				<td class="btbg1 font-center">&nbsp;</td>
				<td class="btbg1 font-center">&nbsp;</td>
				<td class="btbg1 font-center">&nbsp;</td>
				<td class="btbg1 font-center">&nbsp;</td>
				<td class="btbg1 font-center">&nbsp;</td>
				<td class="btbg1 font-center">&nbsp;</td>
				<td class="btbg1 font-center">&nbsp;</td>
				<td class="btbg1 font-center">&nbsp;</td>
				<td class="btbg1 font-center">&nbsp;</td>
				<td class="btbg1 font-center">&nbsp;</td>
			</tr>
		</table>
	</div>
</body>
</html>
